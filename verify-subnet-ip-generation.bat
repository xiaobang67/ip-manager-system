@echo off
echo ========================================
echo 网段IP地址自动生成功能验证
echo ========================================

echo.
echo 正在检查服务状态...
docker-compose ps

echo.
echo ========================================
echo 验证步骤：
echo ========================================
echo.
echo 1. 打开浏览器访问: http://localhost
echo 2. 登录系统（用户名: admin, 密码: admin123）
echo 3. 进入"网段管理"页面
echo 4. 点击"添加网段"按钮
echo 5. 创建一个测试网段，例如：
echo    - 网段: 192.168.200.0/28
echo    - 子网掩码: 255.255.255.240
echo    - 网关: 192.168.200.1
echo    - 描述: 测试网段
echo 6. 点击"创建"按钮
echo 7. 创建成功后，进入"IP地址管理"页面
echo 8. 检查是否显示了该网段的所有IP地址
echo.
echo ========================================
echo 预期结果：
echo ========================================
echo.
echo ✅ 网段创建成功
echo ✅ IP管理页面显示14个IP地址（192.168.200.1-192.168.200.14）
echo ✅ 所有IP地址状态为"可用"
echo ✅ 网段统计信息正确显示
echo.
echo ========================================
echo 如果遇到问题：
echo ========================================
echo.
echo 1. 检查后端日志：
echo    docker-compose logs backend --tail=20
echo.
echo 2. 查看IP生成日志：
echo    应该看到类似以下的日志信息：
echo    "开始为网段 192.168.200.0/28 生成IP地址..."
echo    "成功生成 14 个IP地址"
echo.
echo 3. 如果没有看到IP生成日志，说明修复未生效
echo.
echo 按任意键打开浏览器进行测试...
pause

start http://localhost

echo.
echo 浏览器已打开，请按照上述步骤进行验证
echo.
echo 测试完成后，可以删除测试网段：
echo 1. 在网段管理页面找到测试网段
echo 2. 点击"删除"按钮（只有在没有已分配IP时才能删除）
echo.
pause