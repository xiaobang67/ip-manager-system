2025-09-10 16:43:14,784 - INFO - ==================================================
2025-09-10 16:43:14,785 - INFO - 开始执行时区修复脚本
2025-09-10 16:43:14,786 - INFO - ==================================================
2025-09-10 16:43:18,892 - ERROR - 数据库连接失败: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
2025-09-10 16:43:18,893 - ERROR - 无法连接数据库，退出
2025-09-10 16:45:43,169 - INFO - ==================================================
2025-09-10 16:45:43,169 - INFO - 开始执行时区修复脚本
2025-09-10 16:45:43,169 - INFO - ==================================================
2025-09-10 16:45:43,211 - INFO - 数据库连接成功
2025-09-10 16:45:43,211 - INFO - 设置MySQL时区为北京时间...
2025-09-10 16:45:43,212 - INFO - 当前时区: +08:00, 当前时间: 2025-09-10 16:45:43
2025-09-10 16:45:43,212 - INFO - MySQL时区设置完成
2025-09-10 16:45:43,213 - INFO - 开始备份数据...
2025-09-10 16:45:43,404 - INFO - 数据备份完成
2025-09-10 16:45:43,404 - INFO - 开始修复表 users 的时区...
2025-09-10 16:45:43,405 - INFO - 表 users 共有 3 条记录需要处理
2025-09-10 16:45:43,405 - INFO - 执行SQL: 
                UPDATE users 
                SET created_at = DATE_ADD(created_at, INTERVAL 8 HOUR), updated_at = DATE_ADD(updated_at, INTERVAL 8 HOUR)
                WHERE created_at IS NOT NULL
            
2025-09-10 16:45:43,410 - INFO - 表 users 时区修复完成，影响 3 条记录
2025-09-10 16:45:43,410 - INFO - 开始修复表 subnets 的时区...
2025-09-10 16:45:43,411 - INFO - 表 subnets 共有 7 条记录需要处理
2025-09-10 16:45:43,411 - INFO - 执行SQL: 
                UPDATE subnets 
                SET created_at = DATE_ADD(created_at, INTERVAL 8 HOUR), updated_at = DATE_ADD(updated_at, INTERVAL 8 HOUR)
                WHERE created_at IS NOT NULL
            
2025-09-10 16:45:43,418 - INFO - 表 subnets 时区修复完成，影响 7 条记录
2025-09-10 16:45:43,419 - INFO - 开始修复表 ip_addresses 的时区...
2025-09-10 16:45:43,421 - INFO - 表 ip_addresses 共有 1782 条记录需要处理
2025-09-10 16:45:43,421 - INFO - 执行SQL: 
                UPDATE ip_addresses 
                SET allocated_at = DATE_ADD(allocated_at, INTERVAL 8 HOUR), created_at = DATE_ADD(created_at, INTERVAL 8 HOUR), updated_at = DATE_ADD(updated_at, INTERVAL 8 HOUR)
                WHERE allocated_at IS NOT NULL
            
2025-09-10 16:45:43,429 - INFO - 表 ip_addresses 时区修复完成，影响 16 条记录
2025-09-10 16:45:43,429 - INFO - 开始修复表 audit_logs 的时区...
2025-09-10 16:45:43,430 - INFO - 表 audit_logs 共有 7 条记录需要处理
2025-09-10 16:45:43,430 - INFO - 执行SQL: 
                UPDATE audit_logs 
                SET created_at = DATE_ADD(created_at, INTERVAL 8 HOUR)
                WHERE created_at IS NOT NULL
            
2025-09-10 16:45:43,439 - INFO - 表 audit_logs 时区修复完成，影响 7 条记录
2025-09-10 16:45:43,439 - INFO - 开始修复表 alert_history 的时区...
2025-09-10 16:45:43,441 - INFO - 表 alert_history 共有 0 条记录需要处理
2025-09-10 16:45:43,441 - INFO - 表 alert_history 没有数据，跳过
2025-09-10 16:45:43,441 - INFO - 开始修复表 alert_rules 的时区...
2025-09-10 16:45:43,443 - INFO - 表 alert_rules 共有 1 条记录需要处理
2025-09-10 16:45:43,443 - INFO - 执行SQL: 
                UPDATE alert_rules 
                SET created_at = DATE_ADD(created_at, INTERVAL 8 HOUR)
                WHERE created_at IS NOT NULL
            
2025-09-10 16:45:43,448 - INFO - 表 alert_rules 时区修复完成，影响 1 条记录
2025-09-10 16:45:43,449 - INFO - 开始修复表 tags 的时区...
2025-09-10 16:45:43,455 - INFO - 表 tags 共有 10 条记录需要处理
2025-09-10 16:45:43,455 - INFO - 执行SQL: 
                UPDATE tags 
                SET created_at = DATE_ADD(created_at, INTERVAL 8 HOUR)
                WHERE created_at IS NOT NULL
            
2025-09-10 16:45:43,462 - INFO - 表 tags 时区修复完成，影响 10 条记录
2025-09-10 16:45:43,462 - INFO - 开始修复表 custom_fields 的时区...
2025-09-10 16:45:43,466 - INFO - 表 custom_fields 共有 8 条记录需要处理
2025-09-10 16:45:43,467 - INFO - 执行SQL: 
                UPDATE custom_fields 
                SET created_at = DATE_ADD(created_at, INTERVAL 8 HOUR)
                WHERE created_at IS NOT NULL
            
2025-09-10 16:45:43,477 - INFO - 表 custom_fields 时区修复完成，影响 8 条记录
2025-09-10 16:45:43,477 - INFO - 开始修复表 system_configs 的时区...
2025-09-10 16:45:43,479 - INFO - 表 system_configs 共有 17 条记录需要处理
2025-09-10 16:45:43,479 - INFO - 执行SQL: 
                UPDATE system_configs 
                SET updated_at = DATE_ADD(updated_at, INTERVAL 8 HOUR)
                WHERE updated_at IS NOT NULL
            
2025-09-10 16:45:43,485 - INFO - 表 system_configs 时区修复完成，影响 17 条记录
2025-09-10 16:45:43,486 - INFO - 成功修复 9/9 个表
2025-09-10 16:45:43,486 - INFO - 验证时区修复结果...
2025-09-10 16:45:43,486 - INFO - 
用户表最新记录:
2025-09-10 16:45:43,488 - INFO -   ('zhangsan', datetime.datetime(2025, 9, 10, 23, 52, 8), datetime.datetime(2025, 9, 10, 23, 52, 8))
2025-09-10 16:45:43,488 - INFO -   ('xiaobang', datetime.datetime(2025, 9, 6, 0, 18, 58), datetime.datetime(2025, 9, 10, 23, 41))
2025-09-10 16:45:43,488 - INFO -   ('admin', datetime.datetime(2025, 9, 3, 18, 58, 17), datetime.datetime(2025, 9, 11, 0, 29, 30))
2025-09-10 16:45:43,488 - INFO - 
IP地址表最新记录:
2025-09-10 16:45:43,489 - INFO -   ('192.168.0.1', datetime.datetime(2025, 9, 9, 21, 51, 37), datetime.datetime(2025, 9, 9, 21, 50, 46))
2025-09-10 16:45:43,489 - INFO -   ('192.168.105.5', datetime.datetime(2025, 9, 9, 19, 9, 20), datetime.datetime(2025, 9, 9, 1, 42, 23))
2025-09-10 16:45:43,489 - INFO -   ('192.168.105.1', datetime.datetime(2025, 9, 9, 19, 21, 25), datetime.datetime(2025, 9, 9, 1, 42, 23))
2025-09-10 16:45:43,490 - INFO - 
子网表最新记录:
2025-09-10 16:45:43,490 - INFO -   ('192.168.220.0/24', datetime.datetime(2025, 9, 9, 21, 58, 9), datetime.datetime(2025, 9, 9, 21, 58, 28))
2025-09-10 16:45:43,490 - INFO -   ('192.168.105.0/24', datetime.datetime(2025, 9, 9, 1, 42, 23), datetime.datetime(2025, 9, 9, 1, 42, 23))
2025-09-10 16:45:43,490 - INFO -   ('192.168.99.0/24', datetime.datetime(2025, 9, 9, 1, 41, 7), datetime.datetime(2025, 9, 9, 1, 41, 7))
2025-09-10 16:45:43,490 - INFO - ==================================================
2025-09-10 16:45:43,491 - INFO - 时区修复脚本执行完成
2025-09-10 16:45:43,491 - INFO - ==================================================
2025-09-10 16:45:43,491 - INFO - 数据库连接已关闭
