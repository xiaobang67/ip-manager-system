import{V as m,d as j,r as y,a as E,o as J,c as O,b as a,e,w as s,U as K,n as x,i as o,D as Q,j as A,g as P,x as k,l as i,t as u,J as W,K as q,_ as F}from"./index-de8d932e.js";const G={getLDAPConfig:()=>m.get("/api/v1/system/ldap-config"),saveLDAPConfig:c=>m.post("/api/v1/system/ldap-config",c),testLDAPConnection:c=>m.post("/api/v1/system/ldap-test",c),getOperationLogs:c=>m.get("/v1/system/logs",{params:c})},H={class:"system-settings"},R={class:"card-header"},X={class:"stat-item"},Y={class:"stat-value"},Z={class:"stat-item"},$={class:"stat-value"},tt={class:"stat-item"},et={class:"stat-value"},st={class:"stat-item"},at={class:"stat-value"},lt={class:"stat-item"},ot={class:"stat-value"},nt={class:"stat-item"},it={class:"stat-value"},dt={class:"info-content"},rt={class:"card-header"},ut={class:"pagination-section"},pt=j({__name:"SystemSettings",setup(c){const b=y(!1),g=y(!1),p=y({total_users:0,active_users:0,ldap_users:0,local_users:0,total_groups:0,ldap_groups:0,active_sessions:0}),z=y([]),d=E({page:1,size:10,total:0}),M=l=>new Date(l).toLocaleString("zh-CN"),B=l=>({登录:"success",登出:"info",创建用户:"primary",修改用户:"warning",删除用户:"danger"})[l]||"info",C=async()=>{b.value=!0;try{const l=await K.getAuthStats();p.value=l}catch(l){x.error("加载统计数据失败"),console.error(l)}finally{b.value=!1}},f=async()=>{g.value=!0;try{const l=await G.getOperationLogs({skip:(d.page-1)*d.size,limit:d.size});z.value=l.items,d.total=l.total}catch(l){x.error("加载操作日志失败"),console.error(l)}finally{g.value=!1}};return J(()=>{C(),f()}),(l,t)=>{const L=o("el-icon"),h=o("el-button"),r=o("el-col"),w=o("el-row"),N=o("el-divider"),S=o("el-card"),v=o("el-descriptions-item"),V=o("el-descriptions"),_=o("el-table-column"),D=o("el-tag"),I=o("el-table"),T=o("el-pagination"),U=Q("loading");return A(),O("div",H,[t[18]||(t[18]=a("div",{class:"page-header"},[a("div",{class:"header-content"},[a("h1",null,"系统设置"),a("p",null,"管理系统配置和认证设置")])],-1)),e(w,{gutter:20},{default:s(()=>[e(r,{span:24},{default:s(()=>[e(S,{class:"stats-card"},{header:s(()=>[a("div",R,[t[3]||(t[3]=a("h3",null,"认证统计",-1)),e(h,{onClick:C,loading:b.value},{default:s(()=>[e(L,null,{default:s(()=>[e(P(k))]),_:1}),t[2]||(t[2]=i(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:s(()=>[e(w,{gutter:20},{default:s(()=>[e(r,{span:8},{default:s(()=>[a("div",X,[a("div",Y,u(p.value.total_users),1),t[4]||(t[4]=a("div",{class:"stat-label"},"总用户数",-1))])]),_:1}),e(r,{span:8},{default:s(()=>[a("div",Z,[a("div",$,u(p.value.active_users),1),t[5]||(t[5]=a("div",{class:"stat-label"},"活跃用户",-1))])]),_:1}),e(r,{span:8},{default:s(()=>[a("div",tt,[a("div",et,u(p.value.local_users),1),t[6]||(t[6]=a("div",{class:"stat-label"},"本地用户",-1))])]),_:1})]),_:1}),e(N),e(w,{gutter:20},{default:s(()=>[e(r,{span:8},{default:s(()=>[a("div",st,[a("div",at,u(p.value.total_groups),1),t[7]||(t[7]=a("div",{class:"stat-label"},"总组数",-1))])]),_:1}),e(r,{span:8},{default:s(()=>[a("div",lt,[a("div",ot,u(p.value.total_groups),1),t[8]||(t[8]=a("div",{class:"stat-label"},"本地组",-1))])]),_:1}),e(r,{span:8},{default:s(()=>[a("div",nt,[a("div",it,u(p.value.active_sessions),1),t[9]||(t[9]=a("div",{class:"stat-label"},"活跃会话",-1))])]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{span:24},{default:s(()=>[e(S,{class:"info-card"},{header:s(()=>[...t[10]||(t[10]=[a("h3",null,"系统信息",-1)])]),default:s(()=>[a("div",dt,[e(V,{column:1,border:""},{default:s(()=>[e(v,{label:"系统名称"},{default:s(()=>[...t[11]||(t[11]=[i(" 企业IP地址管理系统 ",-1)])]),_:1}),e(v,{label:"系统版本"},{default:s(()=>[...t[12]||(t[12]=[i(" v1.0.0 ",-1)])]),_:1}),e(v,{label:"认证方式"},{default:s(()=>[...t[13]||(t[13]=[i(" 本地认证 ",-1)])]),_:1}),e(v,{label:"会话管理"},{default:s(()=>[...t[14]||(t[14]=[i(" JWT令牌 ",-1)])]),_:1}),e(v,{label:"数据库"},{default:s(()=>[...t[15]||(t[15]=[i(" MySQL ",-1)])]),_:1})]),_:1})])]),_:1})]),_:1}),e(r,{span:24},{default:s(()=>[e(S,{class:"log-card"},{header:s(()=>[a("div",rt,[t[17]||(t[17]=a("h3",null,"最近操作",-1)),e(h,{onClick:f,loading:g.value},{default:s(()=>[e(L,null,{default:s(()=>[e(P(k))]),_:1}),t[16]||(t[16]=i(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:s(()=>[W((A(),q(I,{data:z.value,style:{width:"100%"}},{default:s(()=>[e(_,{prop:"timestamp",label:"时间",width:"160"},{default:s(({row:n})=>[i(u(M(n.timestamp)),1)]),_:1}),e(_,{prop:"user",label:"操作用户",width:"120"}),e(_,{prop:"action",label:"操作类型",width:"120"},{default:s(({row:n})=>[e(D,{type:B(n.action)},{default:s(()=>[i(u(n.action),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"target",label:"操作对象",width:"150"}),e(_,{prop:"description",label:"操作描述","min-width":"200"}),e(_,{prop:"ip",label:"IP地址",width:"130"}),e(_,{prop:"status",label:"状态",width:"80"},{default:s(({row:n})=>[e(D,{type:n.status==="success"?"success":"danger"},{default:s(()=>[i(u(n.status==="success"?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])),[[U,g.value]]),a("div",ut,[e(T,{"current-page":d.page,"onUpdate:currentPage":t[0]||(t[0]=n=>d.page=n),"page-size":d.size,"onUpdate:pageSize":t[1]||(t[1]=n=>d.size=n),total:d.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:f,onCurrentChange:f},null,8,["current-page","page-size","total"])])]),_:1})]),_:1})]),_:1})])}}});const ct=F(pt,[["__scopeId","data-v-729882cf"]]);export{ct as default};
