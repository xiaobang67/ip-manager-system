import{_ as v,m as y,r as a,o as c,c as g,a as s,w as r,b as d,d as C,e as V,f as p}from"./index-1a649ac5-1758176310446.js";const x={name:"Login",data(){return{loginData:{username:"",password:""},rememberPassword:!1,rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},computed:{loading(){return this.$store.getters["auth/loginLoading"]},showTimeoutMessage(){return this.$route.query.timeout==="1"}},methods:{...y("auth",["login"]),saveCredentials(){if(this.rememberPassword){const o={username:this.loginData.username,password:this.loginData.password,remember:!0};localStorage.setItem("loginCredentials",JSON.stringify(o))}else localStorage.removeItem("loginCredentials")},loadCredentials(){try{const o=localStorage.getItem("loginCredentials");if(o){const e=JSON.parse(o);e.remember&&(this.loginData.username=e.username||"",this.loginData.password=e.password||"",this.rememberPassword=!0)}}catch(o){console.error("Failed to load saved credentials:",o),localStorage.removeItem("loginCredentials")}},async handleLogin(){try{if(!await this.$refs.loginForm.validate())return;const e=await this.login(this.loginData);if(e.success){this.saveCredentials(),this.$message.success("登录成功");const m=this.$route.query.redirect||"/dashboard";this.$router.push(m)}else this.$message.error(e.message)}catch(o){console.error("Login error:",o),this.$message.error("登录失败，请重试")}}},created(){this.$store.getters["auth/isAuthenticated"]?this.$router.push("/dashboard"):this.loadCredentials()}},D={class:"login-container"},k={class:"card-header"},L={key:0,class:"timeout-message"};function N(o,e,m,S,t,n){const _=a("el-alert"),u=a("el-input"),i=a("el-form-item"),h=a("el-checkbox"),f=a("el-button"),w=a("el-form"),b=a("el-card");return c(),g("div",D,[s(b,{class:"login-card"},{header:r(()=>[d("div",k,[e[3]||(e[3]=d("h2",null,"欧税通网络资源管理平台",-1)),e[4]||(e[4]=d("p",null,"请登录您的账户",-1)),n.showTimeoutMessage?(c(),g("div",L,[s(_,{title:"会话已超时",description:"由于您长时间未操作，会话已自动过期，请重新登录",type:"warning",closable:!1,"show-icon":""})])):C("",!0)])]),default:r(()=>[s(w,{ref:"loginForm",model:t.loginData,rules:t.rules,"label-width":"0",class:"login-form"},{default:r(()=>[s(i,{prop:"username"},{default:r(()=>[s(u,{modelValue:t.loginData.username,"onUpdate:modelValue":e[0]||(e[0]=l=>t.loginData.username=l),placeholder:"用户名","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),s(i,{prop:"password"},{default:r(()=>[s(u,{modelValue:t.loginData.password,"onUpdate:modelValue":e[1]||(e[1]=l=>t.loginData.password=l),type:"password",placeholder:"密码","prefix-icon":"Lock",size:"large","show-password":"",onKeyup:V(n.handleLogin,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),s(i,null,{default:r(()=>[s(h,{modelValue:t.rememberPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>t.rememberPassword=l),class:"remember-checkbox"},{default:r(()=>[...e[5]||(e[5]=[p(" 记住密码 ",-1)])]),_:1},8,["modelValue"])]),_:1}),s(i,null,{default:r(()=>[s(f,{type:"primary",size:"large",loading:n.loading,onClick:n.handleLogin,class:"login-button"},{default:r(()=>[...e[6]||(e[6]=[p(" 登录 ",-1)])]),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}const P=v(x,[["render",N],["__scopeId","data-v-01465e48"]]);export{P as default};
